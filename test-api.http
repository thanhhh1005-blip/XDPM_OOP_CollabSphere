# ==========================================
# C·∫§U H√åNH BI·∫æN M√îI TR∆Ø·ªúNG
# ==========================================
@identity_url = http://localhost:8083
@ai_url = http://localhost:8084
@gateway_url = http://localhost:8080

# ==========================================
# PH·∫¶N 1: IDENTITY SERVICE (TEST TR·ª∞C TI·∫æP PORT 8083)
# ==========================================

### 1. T·∫°o User m·ªõi (ƒêƒÉng k√Ω)
POST {{identity_url}}/users
Content-Type: application/json

{
  "username": "giangvien_sa1111",
  "password": "Password123!1",
  "email": "gv@collabspsher11e.com",
  "fullName": "Thay Giao A",
  "role": "LECTURER",
  "isActive": true
}

### 2. ƒêƒÉng nh·∫≠p (Login)
# üëâ G·ª≠i request n√†y -> Server tr·∫£ v·ªÅ "token": "eyJ..."
# üëâ COPY chu·ªói token ƒë√≥ ƒë·ªÉ d√πng cho c√°c b∆∞·ªõc sau (n·∫øu c·∫ßn test b·∫£o m·∫≠t)
POST {{identity_url}}/auth/token
Content-Type: application/json

{
  "username": "giangvien_a",
  "password": "Password123!"
}

### 3. Ki·ªÉm tra Token (Introspect)
POST {{identity_url}}/auth/introspect
Content-Type: application/json

{
  "token": "eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJjb2xsYWJzcGhlcmUuY29tIiwic3ViIjoiZ2lhbmd2aWVuX2EiLCJleHAiOjE3NjcwODk0MzYsImlhdCI6MTc2NzA4NTgzNiwidXNlcklkIjoxMCwic2NvcGUiOiJMRUNUVVJFUiJ9.eddLXbdQErECCbaoWnMMl-kvo8ut-zmvrxOGmD1XXZ58MP5lxSyWGiHK_E6WJ7xmicC_BB7wMgGqgshCXn5ixg"
}


# ==========================================
# PH·∫¶N 2: AI SERVICE (TEST TR·ª∞C TI·∫æP PORT 8084)
# ==========================================

### 4. Chat v·ªõi AI (H·ªèi ƒë√°p th√¥ng th∆∞·ªùng)
POST {{ai_url}}/ai/chat
Content-Type: application/json

{
  "question": "Cho t√¥i 3 √Ω t∆∞·ªüng cho ƒë·ªì √°n t·ªët nghi·ªáp ng√†nh CNTT"
}

### 5. T·∫°o M·ªëc D·ª± √Ån t·ª´ ƒê·ªÅ C∆∞∆°ng (T√≠nh nƒÉng m·ªõi!)
# Input: syllabus (String)
# Output: JSON danh s√°ch c√°c m·ªëc d·ª± √°n
POST {{ai_url}}/ai/generate-milestones
Content-Type: application/json

{
  "syllabus": "M√¥n h·ªçc: L·∫≠p tr√¨nh Web n√¢ng cao. M·ª•c ti√™u: Sinh vi√™n x√¢y d·ª±ng ƒë∆∞·ª£c website E-commerce ho√†n ch·ªânh. Tu·∫ßn 1-2: Ph√¢n t√≠ch y√™u c·∫ßu & Thi·∫øt k·∫ø CSDL. Tu·∫ßn 3-5: X√¢y d·ª±ng Backend API v·ªõi Spring Boot. Tu·∫ßn 6-8: X√¢y d·ª±ng Frontend v·ªõi ReactJS. Tu·∫ßn 9: T√≠ch h·ª£p Payment Gateway & Deploy. Tu·∫ßn 10: Demo s·∫£n ph·∫©m."
}


# ==========================================
# PH·∫¶N 3: TEST QUA API GATEWAY (PORT 8080)
# (ƒê√¢y l√† c√°ch Frontend s·∫Ω g·ªçi th·ª±c t·∫ø)
# ==========================================

### 6. ƒêƒÉng nh·∫≠p qua Gateway
POST {{gateway_url}}/identity/auth/token
Content-Type: application/json

{
  "username": "giangvien_a",
  "password": "Password123!"
}

### 7. Chat AI qua Gateway
POST {{gateway_url}}/ai/chat
Content-Type: application/json

{
  "question": "L√†m sao ƒë·ªÉ qu·∫£n l√Ω th·ªùi gian hi·ªáu qu·∫£ trong d·ª± √°n nh√≥m?"
}

### 8. T·∫°o M·ªëc D·ª± √Ån qua Gateway (Quan tr·ªçng nh·∫•t)
POST {{gateway_url}}/ai/generate-milestones
Content-Type: application/json

{
  "syllabus": "ƒê·ªì √°n: X√¢y d·ª±ng ·ª©ng d·ª•ng qu·∫£n l√Ω chi ti√™u c√° nh√¢n. Th·ªùi gian: 1 th√°ng. C√¥ng ngh·ªá: Flutter & Firebase. Y√™u c·∫ßu: C√≥ ch·ª©c nƒÉng nh·∫≠p thu chi, v·∫Ω bi·ªÉu ƒë·ªì b√°o c√°o."
}
##############################################################

### C·∫•u h√¨nh Base URL l√† c·ªïng GATEWAY (8080) + Prefix (/identity)
@baseUrl = http://localhost:8080/identity

# ==========================================
# 1. TEST ƒêƒÇNG NH·∫¨P (QUA GATEWAY)
# ==========================================

### 1.1 ƒêƒÉng nh·∫≠p ADMIN
# POST t·ªõi 8080/identity/auth/token -> Gateway chuy·ªÉn th√†nh 8083/auth/token
POST {{baseUrl}}/auth/token
Content-Type: application/json

{
  "username": "admin01",
  "password": "123"
}

# üëá Script l∆∞u token
> {%
    client.global.set("gatewayToken", response.body.result.token); 
    // L∆∞u √Ω: N·∫øu b·∫°n ch∆∞a l√†m ApiResponse th√¨ d√πng response.body.token
    // N·∫øu ƒë√£ l√†m ApiResponse th√¨ d√πng response.body.result.token
    client.log("Gateway Token: " + client.global.get("gatewayToken"));
%}

# ==========================================
# 2. TEST L·∫§Y TH√îNG TIN (QUA GATEWAY)
# ==========================================

### 2.1 L·∫•y th√¥ng tin ch√≠nh m√¨nh
# GET t·ªõi 8080/identity/users/my-info
GET {{baseUrl}}/users/my-info
Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJjb2xsYWJzcGhlcmUuY29tIiwic3ViIjoiYWRtaW4wMSIsImV4cCI6MTc2Nzc5ODg2MSwiaWF0IjoxNzY3Nzk1MjYxLCJ1c2VySWQiOjEyLCJzY29wZSI6IkFETUlOIn0.oAc2ccVVKrMt0-Wx4IIkWJ_d1mLPLMJc2CY_ZqdES4xOr7QQiLKnWF9Ry528RiSZ2abVqueJqYTPvWrJdaHRHA
Content-Type: application/json

### 2.2 L·∫•y danh s√°ch Users (Ch·ªâ Admin)
GET {{baseUrl}}/users
Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJjb2xsYWJzcGhlcmUuY29tIiwic3ViIjoiYWRtaW4wMSIsImV4cCI6MTc2Nzc5ODg2MSwiaWF0IjoxNzY3Nzk1MjYxLCJ1c2VySWQiOjEyLCJzY29wZSI6IkFETUlOIn0.oAc2ccVVKrMt0-Wx4IIkWJ_d1mLPLMJc2CY_ZqdES4xOr7QQiLKnWF9Ry528RiSZ2abVqueJqYTPvWrJdaHRHA
Content-Type: application/json